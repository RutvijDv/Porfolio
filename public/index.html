<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Web site created using create-react-app" />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />

  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

  <title>React App</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=PT+Serif:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous">
  </script>
</body>
<script>
  var btnMenu = document.getElementsByClassName("btn-menu");
  var body = document.body
  for (var i = 0; i < btnMenu.length; i++) {
    btnMenu[i].addEventListener('click', function () {
      body.classList.toggle('menu-open');
    });
  }


  $(document).ready(function () {
    setupFade();
    setupClickToScroll();
    setupPostAnimation();
    setupScrollToTop();
    enableScrollAbortion();

    // Trigger window.scroll, this will initiate some of the scripts
    $(window).scroll();
  });


  // Allow user to cancel scroll animation by manually scrolling
  function enableScrollAbortion() {
    var $viewport = $('html, body');
    $viewport.on('scroll mousedown DOMMouseScroll mousewheel keyup', function (e) {
      if (e.which > 0 || e.type === 'mousedown' || e.type === 'mousewheel') {
        $viewport.stop();
      }
    });
  }

  function setupScrollToTop() {
    var scrollSpeed = 750;
    $('.trigger-scroll-to-top').click(function (e) {
      e.preventDefault();
      $('html, body').animate({
        scrollTop: 0
      }, scrollSpeed);
    });
  }


  function setupPostAnimation() {
    var posts = $('.post-wrapper .post');
    $(window).on('scroll resize', function () {

      var currScroll = $(window).scrollTop() > $(document).scrollTop() ? $(window).scrollTop() : $(document)
        .scrollTop(),
        windowHeight = $(window).height(), // Needs to be here because window can resize
        overScroll = Math.ceil(windowHeight * .20),
        treshhold = (currScroll + windowHeight) - overScroll;

      posts.each(function () {

        var post = $(this),
          postScroll = post.offset().top

        if (postScroll > treshhold) {
          post.addClass('hidden');
        } else {
          post.removeClass('hidden');
        }

      });

    });
  }

  function setupFade() {

    var posts = $('.post-wrapper .post').reverse(),
      stemWrapper = $('.stem-wrapper'),
      halfScreen = $(window).height() / 2;

    $(window).on('scroll resize', function () {

      delay(function () {

        var currScroll = $(window).scrollTop() > $(document).scrollTop() ? $(window).scrollTop() : $(
            document).scrollTop(),
          scrollSplit = currScroll + halfScreen;

        posts.removeClass('active').each(function () {

          var post = $(this),
            postOffset = post.offset().top;

          if (scrollSplit > postOffset) {

            // Add active class to fade in
            post.addClass('active')

            // Get post color
            var color = post.data('stem-color') ? post.data('stem-color') : null,
              allColors = 'color-green color-yellow color-white'

            stemWrapper.removeClass(allColors);

            if (color !== null) {
              stemWrapper.addClass('color-' + color);
            }

            return false;
          }

        });
      }, 20);

    });

  }


  function setupClickToScroll(post) {

    var scrollSpeed = 750;

    $('.post-wrapper .post .stem-overlay .icon').click(function (e) {
      e.preventDefault();

      var icon = $(this),
        post = icon.closest('.post'),
        postTopOffset = post.offset().top,
        postHeight = post.height(),
        halfScreen = $(window).height() / 2,
        scrollTo = postTopOffset - halfScreen + (postHeight / 2);

      $('html, body').animate({
        scrollTop: scrollTo
      }, scrollSpeed);
    });

  }






  /*==========  Helpers  ==========*/


  // Timeout function
  var delay = (function () {
    var timer = 0;
    return function (callback, ms) {
      clearTimeout(timer);
      timer = setTimeout(callback, ms);
    };
  })();

  $.fn.reverse = function () {
    return this.pushStack(this.get().reverse(), arguments);
  };
</script>

</html>